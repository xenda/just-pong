// Generated by CoffeeScript 1.3.3
(function() {

  window.GameManager = (function() {

    function GameManager(board, leftPaddleEl, rightPaddleEl, ballEl) {
      this.board = board;
      this.leftPaddle = new window.Paddle(leftPaddleEl, this.board);
      this.rightPaddle = new window.Paddle(rightPaddleEl, this.board);
      this.ball = new window.Ball(ballEl, this.board);
      this.tick = 0;
      this.leftScore = 0;
      this.rightScore = 0;
      this.ball.display();
      this.setupControls();
      this.registerListeners();
    }

    GameManager.prototype.setupControls = function() {
      var _this = this;
      key('w', function() {
        return _this.leftPaddle.moveUp();
      });
      key('s', function() {
        return _this.leftPaddle.moveDown();
      });
      key('i', function() {
        return _this.rightPaddle.moveUp();
      });
      return key('k', function() {
        return _this.rightPaddle.moveDown();
      });
    };

    GameManager.prototype.registerListeners = function() {
      var _this = this;
      return $(document).on('score', function(event, side) {
        if (side === 'left') {
          _this.leftScore += 1;
        } else {
          _this.rightScore += 1;
        }
        return _this.updateScores();
      });
    };

    GameManager.prototype.updateScores = function() {
      $("span.left").html("" + this.leftScore);
      return $("span.right").html("" + this.rightScore);
    };

    GameManager.prototype.run = function() {
      var _this = this;
      return setInterval(function() {
        _this.ball.move(_this.tick, _this.leftPaddle, _this.rightPaddle);
        _this.ball.display();
        return _this.tick = +0.1;
      }, 50);
    };

    return GameManager;

  })();

}).call(this);
